general:
  artma_version:
    type: "character"
    default: "0.3.2"
    fixed: true
    help: "Version of the artma package under which these options were generated"

data:
  source_path:
    type: "character"
    prompt: "file"
    help: "Full path to your dataset source"

  na_handling:
    type: "enum: stop|median|mean"
    default: "stop"
    confirm_default: true
    prompt: "readline"
    help: |
      How to handle missing values:
        {cli::symbol$bullet} {.strong stop}: Abort if any missing values are found
        {cli::symbol$bullet} {.strong median}: Replace missing values with the variable's median
        {cli::symbol$bullet} {.strong mean}: Replace missing values with the variable's mean

  colnames:
    obs_id:
      type: "character"
      allow_na: true
      default: .na
      standardize: true
      help: "Column containing observation IDs"

    study:
      type: "character"
      standardize: true
      help: "Column containing study names"

    study_id:
      type: "character"
      allow_na: true
      default: .na
      standardize: true
      help: "Column containing study IDs"

    effect:
      type: "character"
      standardize: true
      help: "Column containing effect estimates"

    se:
      type: "character"
      standardize: true
      help: "Column containing standard errors"

    t_stat:
      type: "character"
      standardize: true
      allow_na: true
      default: .na
      help: "Column containing t-statistics"

    n_obs:
      type: "character"
      standardize: true
      help: "Column containing the number of observations"

    study_size:
      type: "character"
      standardize: true
      allow_na: true
      default: .na
      help: "Column containing the study sizes, i.e. the number of estimates per study"

    reg_dof:
      type: "character"
      standardize: true
      allow_na: true
      default: .na
      help: "Column containing the degrees of freedom for the regression"

    precision:
      type: "character"
      standardize: true
      allow_na: true
      default: .na
      help: "Column containing the precision of the effect estimates"

  config_setup:
    type: "enum: auto|manual"
    default: "auto"
    confirm_default: true
    prompt: "readline"
    help: |
      How to configure the data:
        {cli::symbol$bullet} {.strong auto}: Automatically generate and validate the data configuration
        {cli::symbol$bullet} {.strong manual}: Manually configure and validate the data configuration

  config:
    type: "list"
    default: .na
    allow_na: true
    prompt: "function"
    prompt_function: "prompt_data_config"
    help: |
      A list of configuration options for the data.
      Each variable in the dataset requires a list of configuration options.
      For more details, read the 'data_config' vignette.

calc:
  precision_type:
    type: "enum: '1/SE'|'DoF'"
    default: "1/SE"
    help: |
      The type of precision to calculate:
        {cli::symbol$bullet} {.strong 1/SE}: Calculate precision as 1/SE
        {cli::symbol$bullet} {.strong DoF}: Calculate precision as sqrt(DoF)

  se_zero_handling:
    type: "enum: stop|warn|ignore"
    default: "stop"
    help: |
      Having standard errors equal to zero can lead to division by zero errors, introducing infinite t-statistics.
      By default, the package will stop if any zero standard errors are found.
      You can change this behavior by setting the option to 'warn' or 'ignore'.
      How to handle zero standard errors:
        {cli::symbol$bullet} {.strong stop}: Abort if any zero standard errors are found
        {cli::symbol$bullet} {.strong warn}: Warn if any zero standard errors are found
        {cli::symbol$bullet} {.strong ignore}: Ignore zero standard errors

methods:
  add_significance_marks:
    type: "logical"
    default: true
    help: |
      If `TRUE`, append significance asterisks to coefficient estimates across all
      model diagnostics.

  variable_summary_stats:
    use_verbose_names:
      type: "logical"
      default: true
      help: |
        If `TRUE`, print out the descriptive variable names. If `FALSE`,
        print out the data frame column names. Defaults to `TRUE`.

  effect_summary_stats:
    conf_level:
      type: "numeric"
      default: 0.95
      help: |
        The confidence level for the confidence intervals. Defaults to 0.95 (95%).

    formal_output:
      type: "logical"
      default: false
      help: |
        If `TRUE`, return the table in a form that can be used in LaTeX. Defaults to `FALSE`.

  linear_tests:
    bootstrap_replications:
      type: "integer"
      default: 100
      help: |
        Number of bootstrap replications to use when computing cluster-robust
        confidence intervals. Set to `0` to disable bootstrapping.

    conf_level:
      type: "numeric"
      default: 0.95
      help: |
        Confidence level used for bootstrap intervals. Must lie between 0 and 1.

  nonlinear_tests:
    round_to:
      type: "integer"
      allow_na: true
      default: .na
      help: |
        Override the default number of decimals shown in the non-linear summary.
        Leave unset to use the global output option.

    stem_representative_sample:
      type: "enum: medians|first|all"
      default: "medians"
      help: |
        Choose the representative observation per study when running the STEM
        estimator. Use {.strong medians} to rely on study medians, {.strong first}
        to pick the first observation, or {.strong all} to use every estimate.

    selection_cutoffs:
      type: "numeric"
      default: [1.96]
      help: |
        Cut-off values supplied to the selection model. Provide one or more
        positive values corresponding to the publication probability thresholds.

    selection_symmetric:
      type: "logical"
      default: false
      help: |
        If `TRUE`, impose symmetry when estimating the selection model.

    selection_model:
      type: "enum: normal|t"
      default: "normal"
      help: |
        Distributional assumption used by the selection model.

    hierarchical_iterations:
      type: "integer"
      default: 6000
      help: |
        Number of posterior draws to request from the hierarchical model.

  exogeneity_tests:
    iv_instrument:
      type: "enum: automatic|1/sqrt(n_obs)|1/n_obs|1/n_obs^2|log(n_obs)"
      default: "automatic"
      help: |
        Instrument to use for the instrumental variable (IV) regression.
        Use {.strong automatic} to automatically select the best instrument
        based on diagnostics (R-squared, weak instruments, Wu-Hausman, Sargan).
        Alternatively, specify a specific instrument formula involving n_obs.

    puniform_alpha:
      type: "numeric"
      default: 0.05
      help: |
        Significance level for the p-uniform* selection model.
        Defaults to 0.05 (5%).

    puniform_method:
      type: "enum: ML|P"
      default: "ML"
      help: |
        Estimation method for p-uniform*.
        Use {.strong ML} for maximum likelihood or {.strong P} for method of moments.

  p_hacking_tests:
    include_caliper:
      type: "logical"
      default: true
      help: |
        If `TRUE`, include Caliper tests (Gerber & Malhotra, 2008) for selective
        reporting around significance thresholds.

    caliper_thresholds:
      type: "numeric"
      default: [1.645, 1.96, 2.58]
      help: |
        T-statistic thresholds to test with the Caliper method.
        Default tests at 1.645 (10% significance), 1.96 (5% significance), and 2.58 (1% significance).

    caliper_widths:
      type: "numeric"
      default: [0.05, 0.1, 0.15]
      help: |
        Caliper interval widths to test around each threshold.
        Narrower widths focus on immediate vicinity of the threshold.

    include_elliott:
      type: "logical"
      default: true
      help: |
        If `TRUE`, include Elliott et al. (2022) p-hacking detection tests.

    lcm_iterations:
      type: "integer"
      default: 10000
      help: |
        Number of simulations for LCM test critical values.
        Higher values increase precision but take longer to compute.

    lcm_grid_points:
      type: "integer"
      default: 10000
      help: |
        Number of grid points per LCM simulation.
        Higher values increase accuracy of the Brownian bridge approximation.

    include_discontinuity:
      type: "logical"
      default: true
      help: |
        If `TRUE`, include the discontinuity test at p = 0.05.
        Requires the {.pkg rddensity} package.

    discontinuity_bandwidth:
      type: "numeric"
      default: 0.05
      help: |
        Initial bandwidth for the discontinuity test.
        The algorithm will adaptively adjust if needed.

    include_cox_shi:
      type: "logical"
      default: true
      help: |
        If `TRUE`, include Cox-Shi tests for monotonicity restrictions.
        These tests can detect violations of expected p-value distributions.

    cox_shi_bins:
      type: "integer"
      default: 20
      help: |
        Number of bins for discretization in Cox-Shi tests.
        More bins provide finer resolution but require more observations.

    cox_shi_order:
      type: "integer"
      default: 2
      help: |
        Order of monotonicity (K) for Cox-Shi tests.
        Higher orders impose stricter shape restrictions.

    cox_shi_bounds:
      type: "integer"
      default: 1
      help: |
        Whether to use theoretical bounds in Cox-Shi tests (1 = yes, 0 = no).
        Bounds account for the two-sided nature of t-tests.

    include_maive:
      type: "logical"
      default: true
      help: |
        If `TRUE`, include MAIVE estimator (Irsova et al., 2023) for publication
        bias correction using instrumental variables.

    maive_method:
      type: "integer"
      default: 3
      help: |
        MAIVE method selection:
          1 = FAT-PET
          2 = PEESE
          3 = PET-PEESE (default)
          4 = Endogenous Kink (EK)

    maive_weight:
      type: "integer"
      default: 0
      help: |
        MAIVE weighting scheme:
          0 = No weights (default)
          1 = Standard weights
          2 = Adjusted weights

    maive_instrument:
      type: "integer"
      default: 1
      help: |
        MAIVE instrumenting:
          0 = No instrumenting
          1 = Use instrumental variables (default)

    maive_studylevel:
      type: "integer"
      default: 2
      help: |
        MAIVE study-level correlation structure:
          0 = None
          1 = Fixed effects
          2 = Cluster-robust (default)

    maive_se:
      type: "integer"
      default: 3
      help: |
        MAIVE standard error estimation method:
          1 = Asymptotic
          2 = Pairs cluster bootstrap
          3 = Wild bootstrap (default)
          4 = Wild cluster bootstrap
          5 = Pairs bootstrap

    maive_ar:
      type: "integer"
      default: 1
      help: |
        MAIVE Anderson-Rubin confidence interval:
          0 = Do not compute
          1 = Compute (default)

    maive_first_stage:
      type: "integer"
      default: 0
      help: |
        MAIVE first stage option (default: 0).

output:
  number_of_decimals:
    type: "integer"
    default: 3
    help: |
      The number of decimals to round the output to. Defaults to 3.

verbose:
  type: "integer"
  default: 3
  help: |
    The verbosity level of the package.
    The higher the number, the more verbose the package.
    Defaults to 3.
    Verbosity levels:
      {cli::symbol$bullet} {.strong 1}: Errors only - only stop() conditions
      {cli::symbol$bullet} {.strong 2}: Warnings + errors - warning() and stop() conditions
      {cli::symbol$bullet} {.strong 3}: Info - short progress/high-level info (default)
      {cli::symbol$bullet} {.strong 4}: Debug/trace - everything including internals

cache:
  use_cache:
    type: "logical"
    default: true
    help: |
      If `TRUE`, use caching to speed up the package.
      If `FALSE`, do not use caching.

  cache_age:
    type: "integer"
    default: 3600
    help: |
      The age of the cache in seconds.
      Defaults to 3600 seconds (1 hour).
      If the cache is older than this, it will be invalidated.

temp:
  # A set of options that are only set at runtime but never stored in the options file.
  file_name:
    type: "character"
    allow_na: true
    default: null
    help: |
      Name of the file under which the options is stored.
      This is not required during the file creation, but the option value is added upon loading the file.

  dir_name:
    type: "character"
    allow_na: true
    default: null
    help: |
      Name of the directory to save the options to.
      This is not required during the file creation, but the option value is added upon loading the file.
